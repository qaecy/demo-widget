import{a as Q,c as te,e as ne,f as b}from"./chunk-FKPCN46I.js";import{a as W}from"./chunk-4I4WCNMY.js";import"./chunk-HIDQVL64.js";import{a as H,b as J,c as K,d as X,e as Z,f as ee}from"./chunk-TU6ATKKZ.js";import"./chunk-OYPTGKJ4.js";import"./chunk-T3Q3DASN.js";import{R as U,U as L}from"./chunk-IDJ2CURU.js";import"./chunk-NIQNCP7X.js";import{b as $,d as y,f as B,h as P,j as Y,m as G}from"./chunk-43KZBEMJ.js";import{j as A}from"./chunk-D5SNKE4E.js";import{$ as f,$a as E,Ab as u,Bb as V,Cb as N,Eb as x,Gb as C,Hb as l,Qb as R,Rb as j,Sa as o,Tb as c,Ub as T,ab as O,eb as M,fa as z,ga as _,ha as d,hc as D,jb as m,mb as v,nb as S,pb as w,ra as g,sa as h,ub as p,wb as q,xb as k,yb as a,zb as s}from"./chunk-P4UK33DX.js";var ae=(e,n)=>n.label;function se(e,n){if(e&1){let t=x();a(0,"button",2),C("click",function(){let r=_(t).$implicit;return d(r.action())}),c(1),s()}if(e&2){let t=n.$implicit;o(),T(t.label)}}function le(e,n){if(e&1&&(a(0,"p"),c(1,"Select provider"),s(),q(2,se,2,1,"button",1,ae)),e&2){let t=l();o(2),k(t.ssoProviders())}}function me(e,n){e&1&&(u(0,"br"),a(1,"p"),c(2,"or sign in as"),s())}function pe(e,n){e&1&&(a(0,"p"),c(1,"Sign in with e-mail and password"),s())}function ce(e,n){e&1&&(a(0,"mat-error"),c(1,"Invalid e-mail"),s())}function _e(e,n){if(e&1&&(a(0,"span",6),c(1),s()),e&2){let t=l(2);o(),T(t.errorMsg())}}function de(e,n){if(e&1){let t=x();m(0,me,3,0)(1,pe,2,0,"p"),a(2,"mat-form-field",3),C("keydown.enter",function(){_(t);let r=l();return d(r.userPwSignIn())}),a(3,"mat-label"),c(4,"E-mail"),s(),u(5,"input",4),m(6,ce,2,0,"mat-error"),s(),a(7,"mat-form-field",3),C("keydown.enter",function(){_(t);let r=l();return d(r.userPwSignIn())}),a(8,"mat-label"),c(9,"Password"),s(),u(10,"input",5),s(),m(11,_e,2,1,"span",6),a(12,"button",7),C("click",function(){_(t);let r=l();return d(r.userPwSignIn())}),c(13," Sign in "),s()}if(e&2){let t=l();p(t.ssoProviders().length?0:-1),o(),p(t.ssoProviders().length?-1:1),o(4),w("formControl",t.emailFormControl),o(),p(t.emailFormControl.hasError("email")&&!t.emailFormControl.hasError("required")?6:-1),o(4),w("formControl",t.pwFormControl),o(),p(t.errorMsg()?11:-1),o(),w("disabled",t.emailFormControl.errors||t.pwFormControl.errors)}}var I=class e{_state=f(b);_auth=f(te);_ssoMap=new Map([["microsoft.com",{label:"Microsoft",action:()=>this._auth.selectedProvider="microsoft.com"}]]);_errorCodeMap=new Map([["auth/invalid-email","Invalid e-mail"],["auth/invalid-credential","Invalid credentials"],["auth/network-request-failed","Network request failed"]]);ssoProviders=D(()=>this._state.options().auth.providers.map(n=>this._ssoMap.get(n)).filter(n=>n!==void 0));showUserPW=D(()=>this._state.options().auth.providers.includes("USER_PW"));emailFormControl=new P("",[y.required,y.email]);pwFormControl=new P("",[y.required]);errorMsg=E("");async userPwSignIn(){let n=this.emailFormControl.value,t=this.pwFormControl.value;if(n&&t)try{await this._auth.userPWSignIn(n,t)}catch(i){let r=this._errorCodeMap.get(i.code);r!==void 0?this.errorMsg.set(r):this.errorMsg.set(i.code)}console.log(this.errorMsg())}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=M({type:e,selectors:[["app-sign-in"]],decls:3,vars:2,consts:[[1,"sign-in-container"],["mat-stroked-button",""],["mat-stroked-button","",3,"click"],[3,"keydown.enter"],["type","email","matInput","","placeholder","E-mail",3,"formControl"],["placeholder","Password","type","password","matInput","",3,"formControl"],[1,"mat-mdc-form-field-error"],["mat-stroked-button","",3,"click","disabled"]],template:function(t,i){t&1&&(a(0,"div",0),m(1,le,4,0)(2,de,14,7),s()),t&2&&(o(),p(i.ssoProviders().length?1:-1),o(),p(i.showUserPW()?2:-1))},dependencies:[L,U,X,K,H,J,ee,Z,G,$,B,Y],styles:[".sign-in-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;min-height:100%;gap:.2rem}"]})};var ue=["org"],Ce=()=>[import("./chunk-MW6IAVRC.js").then(e=>e.SyncComponent)],fe=()=>[import("./chunk-TX6K5PNX.js").then(e=>e.ChatComponent)],ge=()=>[import("./chunk-QCWRG5PX.js").then(e=>e.ResourceComponent)];function xe(e,n){if(e&1){let t=x();a(0,"app-organization",1,0),C("requestMembers",function(r){_(t);let F=l(2);return d(F.listOrganizationMembers.emit(r))})("requestName",function(){_(t);let r=l(2);return d(r.organizationNameRequest.emit())}),s()}}function he(e,n){if(e&1){let t=x();a(0,"app-sync",2),C("syncAll",function(r){_(t);let F=l(4);return d(F.sync.emit(r))}),s()}}function Me(e,n){if(e&1&&m(0,he,1,0,"app-sync"),e&2){let t=l(3);p(t.mode()==="sync"?0:-1)}}function ve(e,n){e&1&&u(0,"app-chat")}function Se(e,n){if(e&1&&m(0,ve,1,0,"app-chat"),e&2){let t=l(3);p(t.mode()==="chat"?0:-1)}}function we(e,n){e&1&&u(0,"app-resource")}function ye(e,n){if(e&1&&m(0,we,1,0,"app-resource"),e&2){let t=l(3);p(t.mode()==="resource"?0:-1)}}function be(e,n){if(e&1&&(V(0),m(1,Me,1,1),v(2,1,Ce),m(4,Se,1,1),v(5,4,fe),m(7,ye,1,1),v(8,7,ge),N()),e&2){let t=l(2);o(2),S(t.mode()==="sync"),o(3),S(t.mode()==="chat"),o(3),S(t.mode()==="resource")}}function Ie(e,n){if(e&1&&m(0,xe,2,0,"app-organization")(1,be,10,3,"ng-container"),e&2){let t=l();p(t.userOrganizations().length?1:0)}}function Fe(e,n){e&1&&u(0,"app-sign-in")}var ie=class e{_syncService=f(W);_state=f(b);organizationComponent=O("org");mode=h("sync");pid=h(void 0);dark=h(!0);options=h(new Q);sync=g();listOrganizationMembers=g();listProjectMembers=g();organizationNameRequest=g();projectNameRequest=g();user=this._state.user;authDisabled=this._state.authDisabled;userOrganizations=this._state.userOrganizations;projectData=this._state.projectData;ngOnChanges(n){"options"in n&&(this._state.options=this.options()),"pid"in n&&(this._state.projectId=this.pid())}setSyncList(n){this._syncService.syncList=n}setOrganizationMembers(n){this.organizationComponent()?.setMembers(n)}setOrganizationName(n){this.organizationComponent()?.setName(n)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=M({type:e,selectors:[["app-main"]],viewQuery:function(t,i){t&1&&R(i.organizationComponent,ue,5),t&2&&j()},inputs:{mode:[1,"mode"],pid:[1,"pid"],dark:[1,"dark"],options:[1,"options"]},outputs:{sync:"sync",listOrganizationMembers:"listOrganizationMembers",listProjectMembers:"listProjectMembers",organizationNameRequest:"organizationNameRequest",projectNameRequest:"projectNameRequest"},features:[z],decls:2,vars:2,consts:[["org",""],[3,"requestMembers","requestName"],[3,"syncAll"]],template:function(t,i){t&1&&m(0,Ie,2,1)(1,Fe,1,0,"app-sign-in"),t&2&&(p(i.user()||i.authDisabled()?0:-1),o(),p(!i.user()&&!i.authDisabled()?1:-1))},dependencies:[A,I,ne],encapsulation:2})};export{ie as MainComponent};
