import{a as M}from"./chunk-NKDIAHS4.js";import{a as ne}from"./chunk-VNIUX7X5.js";import{g as d,h as P}from"./chunk-HHT5WJXM.js";import"./chunk-GFULRQS6.js";import{j as te}from"./chunk-DTREXXEI.js";import"./chunk-H4KT4JGL.js";import"./chunk-T3Q3DASN.js";import"./chunk-XXAZQMQ2.js";import"./chunk-YQ7LY5XH.js";import"./chunk-3CERLCYU.js";import"./chunk-J24VGB7T.js";import"./chunk-6QX3GPPT.js";import{a as oe,b as se}from"./chunk-HWRXRBGH.js";import"./chunk-BJE5PLY3.js";import{E as ie,R as re,U as ae}from"./chunk-SJGFJJ2X.js";import{j as ee}from"./chunk-MRQFDQQO.js";import{$ as v,$a as Z,Ab as S,Bb as c,Ma as o,Nb as C,Pb as K,Qb as $,R as V,S as z,U as g,Va as h,Zb as J,_ as D,_a as _,aa as x,bc as F,cb as G,cc as T,db as p,fc as W,ha as q,ia as H,ib as Y,jb as y,ka as k,kb as A,la as L,lb as E,ma as U,mb as Q,ob as m,sa as j,sb as s,tb as a,ub as l,yb as w}from"./chunk-5CVNEI5L.js";import"./chunk-EU2KAMEK.js";import"./chunk-DAQOROHW.js";function fe(t,n){t&1&&l(0,"div",2)}var ue=new z("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var le=(()=>{class t{_elementRef=g(U);_ngZone=g(H);_changeDetectorRef=g(J);_animationMode=g(j,{optional:!0});constructor(){let e=g(ue,{optional:!0});this._isNoopAnimation=this._animationMode==="NoopAnimations",e&&(e.color&&(this.color=this._defaultColor=e.color),this.mode=e.mode||this.mode)}_isNoopAnimation=!1;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";get value(){return this._value}set value(e){this._value=ce(e||0),this._changeDetectorRef.markForCheck()}_value=0;get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=ce(e||0),this._changeDetectorRef.markForCheck()}_bufferValue=0;animationEnd=new q;get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}_mode="determinate";ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._transitionendHandler)})}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._transitionendHandler)}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}_transitionendHandler=e=>{this.animationEnd.observers.length===0||!e.target||!e.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))};static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_({type:t,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(r,i){r&2&&(Y("aria-valuenow",i._isIndeterminate()?null:i.value)("mode",i.mode),Q("mat-"+i.color),E("_mat-animation-noopable",i._isNoopAnimation)("mdc-linear-progress--animation-ready",!i._isNoopAnimation)("mdc-linear-progress--indeterminate",i._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",F],bufferValue:[2,"bufferValue","bufferValue",F],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[G],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(r,i){r&1&&(s(0,"div",0),l(1,"div",1),p(2,fe,1,0,"div",2),a(),s(3,"div",3),l(4,"span",4),a(),s(5,"div",5),l(6,"span",4),a()),r&2&&(o(),A("flex-basis",i._getBufferBarFlexBasis()),o(),m(i.mode==="buffer"?2:-1),o(),A("transform",i._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height, 4px),var(--mdc-linear-progress-active-indicator-height, 4px))}@media(forced-colors: active){.mdc-linear-progress{outline-color:CanvasText}}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height, 4px)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height, 4px);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-sys-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}@media(forced-colors: active){.mdc-linear-progress__buffer-dots{background-color:ButtonBorder}}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-sys-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height, 4px) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}return t})();function ce(t,n=0,e=100){return Math.max(n,Math.min(e,t))}var me=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Z({type:t});static \u0275inj=V({imports:[ie]})}return t})();function ye(t,n){if(t&1){let e=w();s(0,"app-simple-table",1),S("contentChanged",function(i){v(e);let f=c();return x(f.onContentChange(i))}),a()}if(t&2){let e=c();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var R=class t{list=L.required();tableData=h([]);columnDefs=[];filteredList=k();ngOnChanges(){let n=new d("sync","Sync","right");n.type="CHECKBOX",n.editable=!0;let e=new d("open","","center");e.type="HTMLELEMENT",this.columnDefs=[new d("name","Name"),new d("modified","Modified"),e,n];let r=this.list().filter(i=>i.outdated).map(i=>{let{iri:f,size:B,modified:I,name:X}=i,u=document.createElement("button");return u.innerText="open",u.style.background="rgba(0,0,0,0)",u.style.border="1px solid",u.style.cursor="pointer",u.style.borderRadius="2px",u.addEventListener("click",()=>{window.open(f,"_blank")}),{id:f,size:B,modified:M(I),name:X,sync:!0,open:u}});this.tableData.update(()=>[...r])}onContentChange(n){let e=n.filter(i=>i.sync).map(i=>i.id),r=this.list().filter(i=>e.includes(i.iri));this.filteredList.emit(r)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=_({type:t,selectors:[["app-sync-list"]],inputs:{list:[1,"list"]},outputs:{filteredList:"filteredList"},features:[D],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"],[3,"contentChanged","displayFilter","data","columnDefs"]],template:function(e,r){e&1&&p(0,ye,1,3,"app-simple-table",0),e&2&&m(r.tableData().length?0:-1)},dependencies:[P,ee],encapsulation:2})};function be(t,n){if(t&1&&l(0,"app-simple-table",0),t&2){let e=c();y("displayFilter",!1)("data",e.tableData())("columnDefs",e.columnDefs)}}var O=class t{list=L.required();tableData=h([]);columnDefs=[];ngOnChanges(){let n=new d("sync","Sync","right");n.type="CHECKBOX",n.editable=!0;let e=new d("open","","center");e.type="HTMLELEMENT",this.columnDefs=[new d("name","Name"),new d("modified","Modified"),new d("lastSync","Last sync"),e];let r=this.list().map(i=>{let{iri:f,size:B,modified:I,lastSync:X,name:u}=i,b=document.createElement("button");return b.innerText="open",b.style.background="rgba(0,0,0,0)",b.style.border="1px solid",b.style.cursor="pointer",b.style.borderRadius="2px",b.addEventListener("click",()=>{window.open(f,"_blank")}),{id:f,size:B,modified:M(I),lastSync:M(X),name:u,open:b}});this.tableData.update(()=>[...r])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=_({type:t,selectors:[["app-synced-list"]],inputs:{list:[1,"list"]},features:[D],decls:1,vars:1,consts:[[3,"displayFilter","data","columnDefs"]],template:function(e,r){e&1&&p(0,be,1,3,"app-simple-table",0),e&2&&m(r.tableData().length?0:-1)},dependencies:[P],encapsulation:2})};function he(t,n){if(t&1&&(s(0,"span",1),C(1,"All files are up to date. The files synced from the host application are shown below:"),a(),s(2,"div",2),l(3,"app-synced-list",3),a()),t&2){let e=c();o(3),y("list",e.syncTable())}}function Ce(t,n){if(t&1){let e=w();s(0,"button",5),S("click",function(){v(e);let i=c(2);return x(i.requestList())}),C(1," Sync "),l(2,"mat-icon",6),a()}if(t&2){let e=c(2);E("pulse",e.syncInProgress())}}function ve(t,n){if(t&1&&(s(0,"div",8)(1,"span"),C(2),a(),l(3,"mat-progress-bar",9),a()),t&2){let e=c(3);o(2),K("",e.syncPct()," %"),o(),y("value",e.syncPct())}}function xe(t,n){if(t&1){let e=w();s(0,"button",5),S("click",function(){v(e);let i=c(3);return x(i.doSync())}),C(1," Confirm "),l(2,"mat-icon",10),a()}if(t&2){let e=c(3);E("pulse",e.syncInProgress())}}function we(t,n){if(t&1){let e=w();s(0,"div",2)(1,"app-sync-list",7),S("filteredList",function(i){v(e);let f=c(2);return x(f.onFilteredListUpdated(i))}),a()(),p(2,ve,4,2,"div",8)(3,xe,3,2,"button",4)}if(t&2){let e=c(2);o(),y("list",e.syncTable()),o(),m(e.syncPct()!==0?2:-1),o(),m(e.readyToSync()?3:-1)}}function Se(t,n){if(t&1&&(s(0,"span",1),C(1),l(2,"br"),C(3," Select in the list below which files to sync. "),a(),p(4,Ce,3,2,"button",4)(5,we,4,3)),t&2){let e=c();o(),$(" Received ",e.hostFileCount()," files from host and ",e.needSyncCount()," need to be synced."),o(3),m(e.syncTable().length?-1:4),o(),m(e.syncTable().length?5:-1)}}var pe=class t{_syncService=g(ne);_state=g(te);syncRequest=k();syncInProgress=h(!1);syncTable=this._syncService.syncTable;syncPct=this._syncService.syncPct;hostFileCount=T(()=>this.syncTable().length);needSyncCount=T(()=>this.syncTable().filter(n=>n.outdated).length);readyToSync=T(()=>this._filteredList().length&&this.syncPct()===0);allUpToDate=T(()=>this.needSyncCount()===0);_filteredList=h([]);onSyncListReceived=W(()=>{this.syncInProgress.set(!1);let n=this.syncTable().filter(e=>e.outdated);this._filteredList.set(n)});requestList(){let n=this._state.projectData()?.lastSync;this.syncRequest.emit({lastSync:n}),this.syncInProgress.set(!0)}async doSync(){this.syncInProgress.set(!0),await this._syncService.sync(this._filteredList()),this.syncInProgress.set(!1)}onFilteredListUpdated(n){this._filteredList.set(n)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=_({type:t,selectors:[["app-sync"]],outputs:{syncRequest:"syncRequest"},decls:3,vars:1,consts:[[1,"sync-container"],[1,"msg"],[1,"list"],[3,"list"],["mat-stroked-button","",3,"pulse"],["mat-stroked-button","",3,"click"],["aria-hidden","false","aria-label","Sync files","fontIcon","sync"],[3,"filteredList","list"],[1,"sync-status"],["mode","determinate",2,"width","100%",3,"value"],["aria-hidden","false","aria-label","Confirm sync","fontIcon","sync"]],template:function(e,r){e&1&&(s(0,"div",0),p(1,he,4,1)(2,Se,6,4),a()),e&2&&(o(),m(r.allUpToDate()?1:2))},dependencies:[ae,re,se,oe,R,O,me,le],styles:[".sync-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;justify-content:center;overflow:hidden;width:100%;height:100%;gap:.5rem}.msg[_ngcontent-%COMP%]{font-size:.7rem;padding:1rem}.list[_ngcontent-%COMP%]{overflow-y:auto;width:100%}.sync-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;padding:1rem;gap:.5 rem}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation 2s infinite}@keyframes _ngcontent-%COMP%_pulse-animation{0%{box-shadow:0 0 #0003}to{box-shadow:0 0 0 20px #0000}}"]})};export{pe as SyncComponent};
